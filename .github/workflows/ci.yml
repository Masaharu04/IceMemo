name: iOS CI (PR only)

on:
  pull_request:
    branches: [ develop, main ]
    paths-ignore:
      - '**/*.md'
      - '.github/**'

jobs:
  build:
    runs-on: macos-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Set up Xcode
        run: sudo xcode-select -s /Applications/Xcode.app

      - name: Install dependencies
        run: |
          if ! command -v swiftlint &> /dev/null || ! command -v swift-format &> /dev/null; then
            brew install swiftlint swift-format
          fi
          gem install xcpretty

      - name: Fetch base branch
        run: git fetch origin ${{ github.event.pull_request.base.ref }}

      - name: Run SwiftLint on changed files
        run: |
          CHANGED_FILES=$(git diff --name-only origin/${{ github.event.pull_request.base.ref }}...HEAD -- '*.swift')
          echo "Changed Swift files:"
          echo "$CHANGED_FILES"

          if [ -z "$CHANGED_FILES" ]; then
            echo "âœ… No Swift files changed."
          else
            echo "ðŸ§¹ Running SwiftLint on changed files..."
            for file in $CHANGED_FILES; do
              echo "Linting $file"
              swiftlint --path "$file" || true
            done
          fi

      - name:
