name: CI Build Check for iOS

on:
  push:
    branches: [ "main", "develop" ]
  pull_request:
    branches: [ "main", "develop" ]


jobs:
  fastlane_ci_build:
    name: Fastlane Build Check
    runs-on: macos-latest
    
    steps:
      # ... (Checkout, Ruby ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãªã©ã®æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰) ...
      
      - name: ğŸš€ Run Fastlane ci_build_check
        # Fastlaneè‡ªä½“ã¯æˆåŠŸ/å¤±æ•—ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¿”ã—ã¾ã™
        run: bundle exec fastlane ci_build_check
        env:
          FASTLANE_SKIP_UPDATE_FASTLANE_README: true
          # GITHUB_TOKEN ã¯ Fastlane ã®ã‚¹ãƒ†ãƒƒãƒ—ã‹ã‚‰ã¯å‰Šé™¤ã—ã¦OKã§ã™

      # ------------------------------------
      # âœ… (NEW) Report Success
      # ------------------------------------
      - name: âœ… Report Success Status to PR
        # ç›´å‰ã®ã‚¹ãƒ†ãƒƒãƒ—ãŒæˆåŠŸã—ãŸå ´åˆã®ã¿å®Ÿè¡Œ
        if: success()
        uses: Sibz/github-status-action@v1.1.0
        with:
          status: success
          description: 'Build check successful'
          context: 'fastlane-ci-build-check' # ãƒ–ãƒ©ãƒ³ãƒä¿è­·ãƒ«ãƒ¼ãƒ«ã§ä½¿ã£ãŸåå‰
          sha: ${{ github.event.pull_request.head.sha || github.sha }}
          
      # ------------------------------------
      # âŒ (NEW) Report Failure
      # ------------------------------------
      - name: âŒ Report Failure Status to PR
        # ç›´å‰ã®ã‚¹ãƒ†ãƒƒãƒ—ãŒå¤±æ•—ã—ãŸå ´åˆã®ã¿å®Ÿè¡Œ
        if: failure()
        uses: Sibz/github-status-action@v1.1.0
        with:
          status: failure
          description: 'Build check failed'
          context: 'fastlane-ci-build-check' # ãƒ–ãƒ©ãƒ³ãƒä¿è­·ãƒ«ãƒ¼ãƒ«ã§ä½¿ã£ãŸåå‰
          sha: ${{ github.event.pull_request.head.sha || github.sha }}